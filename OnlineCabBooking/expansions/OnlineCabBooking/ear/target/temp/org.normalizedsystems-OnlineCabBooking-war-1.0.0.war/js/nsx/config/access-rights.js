define(["require","exports","knockout","nsx/util/utils","nsx/triggers","nsx/nsx-profile-access"],(function(e,n,t,i,r,c){"use strict";var o;function s(e,n,t){switch(n){case o.VIEW:return e.canView;case o.CREATE:return e.canCreate;case o.EDIT:return e.canEdit;case o.DELETE:return e.canDelete;case o.ACTION:return e.actions&&(void 0===e.actions[t]||e.actions[t])}}Object.defineProperty(n,"__esModule",{value:!0}),n.getAccessRightsController=n.Right=void 0,function(e){e[e.EDIT=0]="EDIT",e[e.CREATE=1]="CREATE",e[e.VIEW=2]="VIEW",e[e.DELETE=3]="DELETE",e[e.ACTION=4]="ACTION"}(o=n.Right||(n.Right={}));var a=new function(){var e=this;this.config={},this.requestRight=function(n){var o=n.element,a=n.requestedRight,g=n.target,u=o.getQualifiedName(),d=(0,r.defineContinuingTrigger)(),f=(0,r.defineContinuingTrigger)(),E=t.observable(!1);(0,i.isNotDefined)(e.config[u])&&(e.config[u]={rights:{}});var l=e.config[u],h=l.rights;function C(){s(h,a,g)?(E(!0),d.trigger()):f.trigger()}return(0,i.isDefined)(s(h,a,g))?C():(0,i.isDefined)(l.loaded)?(0,r.when)(l.loaded).thenDo(C):(l.loaded=(0,r.defineContinuingTrigger)(),c.getAccessRightsForElement(o,(function(e){var n=e.value;h.canView=n.canView,h.canCreate=n.canCreate,h.canEdit=n.canEdit,h.canDelete=n.canDelete,h.actions=n.actions,l.loaded.trigger(),C()}))),{approved:E,granted:d,refused:f}},this.printConfig=function(){console.log(e.config)}};n.getAccessRightsController=function(){return a}}));