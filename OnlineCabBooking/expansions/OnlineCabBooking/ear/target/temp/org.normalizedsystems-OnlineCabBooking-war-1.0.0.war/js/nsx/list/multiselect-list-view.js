define(["require","exports","knockout","nsx/model/dataref","nsx/triggers"],(function(e,r,n,i,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defineListView=void 0,r.defineListView=function(e,r){r=r||{};var u=e.instanceView,a=n.observableArray(),o=t.defineTrigger(),d=t.defineTrigger();function f(r){var o=t.defineTrigger(),d=t.defineTrigger(),f=t.defineTrigger(),s=t.defineTrigger(),l={value:u.defineInstanceView({details:r}),select:o,addToSelection:d,selectRange:f,selectAll:s,dataRef:(0,i.createDataRef)(r.name,r.id),isPrimarySelection:n.pureComputed((function(){var e=c();return!!e&&e.id===r.id})),isSecondarySelection:n.pureComputed((function(){return a().some((function(e,n){return e.id===r.id&&n>0}))})),isSelected:n.pureComputed((function(){return a().some((function(e){return e.id===r.id}))}))};return o.subscribe((function(){return e=l.dataRef,void(1==(r=a()).length&&r[0].id===e.id?a.removeAll():(a.removeAll(),a.push(e)));var e,r})),d.subscribe((function(){return e=l.dataRef,void(a().some((function(r){return r.id===e.id}))?a.remove((function(r){return r.id===e.id})):a.unshift(e));var e})),f.subscribe((function(){return function(r,n){var t=e.page();a.removeAll();var u=t.indexOf(t.filter((function(e){return e.id===r.id}))[0]),o=t.indexOf(t.filter((function(e){return e.id===n.id}))[0]);if(-1!==u&&-1!==o)if(u<o)for(var d=u;d<=o;d++){var f=t[d];a.unshift((0,i.createDataRef)(f.name,f.id))}else for(d=o;d<=u;d++)f=t[d],a.push((0,i.createDataRef)(f.name,f.id))}(c(),l.dataRef)})),s.subscribe((function(){return function(r){var n=e.page();a.removeAll();for(var t=0;t<n.length;t++){var u=n[t];u.id!==r.id&&a.push((0,i.createDataRef)(u.name,u.id))}a.unshift(r)}(l.dataRef)})),l}function c(){var e=a();return e.length>0?e[0]:void 0}return e.page.subscribe((function(){var r=e.page();a.remove((function(e){return!r.some((function(r){return e.id===r.id}))}))})),o.subscribe((function(){a.removeAll()})),d.subscribe((function(){var r=e.page();a.removeAll();for(var n=0;n<r.length;n++){var t=r[n];a.push((0,i.createDataRef)(t.name,t.id))}})),{items:n.pureComputed((function(){for(var r=[],n=e.page(),i=0;i<n.length;i++){var t=f(n[i]);r.push(t)}return r})),selection:n.pureComputed(c),selectedItems:a,hasSelection:n.pureComputed((function(){return!!a()})),deselect:o,selectAll:d}}}));