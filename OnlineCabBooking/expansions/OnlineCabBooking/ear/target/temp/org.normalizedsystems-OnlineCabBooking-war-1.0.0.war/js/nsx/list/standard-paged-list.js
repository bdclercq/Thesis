define(["require","exports","knockout","nsx/simple-switch","nsx/util/utils"],(function(e,s,t,i,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.defineListModel=void 0,s.defineListModel=function(e,s){s=s||{};var n,a=e.searchMethod,o=e.searchDetails,l=s.sorting||"none",u=s.projection||"info",d=s.pageSize||7,b="none"===l?[]:l.sortFields,f=t.observable([]),c=t.isObservable(d)?d:t.observable(d),p=t.observable(1),g=t.observable(1),v=(0,i.defineSwitch)({defaultValue:1}),O=v.value;function P(){var e,s;r.isDefined(n)&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e=t.unwrap(a),s=t.toJS(o),r.isDefined(e)&&r.isDefined(s)&&(n=e.find({details:s,rowsPerPage:t.unwrap(c),page:O()-1,sortFields:t.unwrap(b),projection:u})).then((function(e){e.success&&(f(e.list),p(e.numberOfPages),g(e.totalNumberOfItems))}))}return O.subscribe(P),O.extend({notify:"always",rateLimit:50}),r.isDefined(s.reloadOn)&&s.reloadOn.subscribe(P),P(),{page:f,rowsPerPage:c,pageNb:O,numberOfPages:p,totalNumberOfItems:g,gotoPage:v,reloadPage:P}}}));