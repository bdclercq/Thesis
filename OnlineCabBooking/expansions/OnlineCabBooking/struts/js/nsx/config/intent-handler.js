define(["require","exports","knockout","nsx/util/utils","nsx/triggers","nsx/nsx-component"],(function(e,n,t,i,r,a){"use strict";var o;Object.defineProperty(n,"__esModule",{value:!0}),n.getIntentHandlerLoader=n.Action=void 0,function(e){e[e.VIEW=0]="VIEW",e[e.CREATE=1]="CREATE",e[e.EDIT=2]="EDIT",e[e.DELETE=3]="DELETE"}(o=n.Action||(n.Action={}));var c=function(){var n=this;this.config={},this.handleIntent=function(e,c){if(function(e){return l.test(e)}(e)){var d=function(e){var n=e.split(".");return a.getComponent(n[0]).getElement(n[1])}(e),f=function(e){var n=e.split(".");return o[n[3].toUpperCase()]}(e),s=d.getQualifiedName();(0,i.isNotDefined)(n.config[s])&&(n.config[s]={}),(0,i.isNotDefined)(n.config[s][f])&&n.loadDefaultIntentHandler(d,f,(function(){!function(e,n){(0,r.defineEventTrigger)({key:e,source:t.observable(n)}).trigger()}(e,c)}))}},this.loadDefaultIntentHandler=function(t,i,a){switch(i){case o.CREATE:!function(n,t,i){var a=n.getComponentName(),c=n.getElementName(),l=a+"/"+c+"/"+c+"-std-create";t({element:n,action:o.CREATE,handlerReference:l}),e([l],(function(e){var n=e.defineCreateDialog();(0,r.when)(n.loaded).thenDo(i)}))}(t,n.registerIntentHandler,a);break;case o.EDIT:!function(n,t,i){var a=n.getComponentName(),c=n.getElementName(),l=a+"/"+c+"/"+c+"-std-edit";t({element:n,action:o.EDIT,handlerReference:l}),e([l],(function(e){var n=e.defineEditDialog();(0,r.when)(n.loaded).thenDo(i)}))}(t,n.registerIntentHandler,a);break;case o.VIEW:!function(n,t,i){var a=n.getComponentName(),c=n.getElementName(),l=a+"/"+c+"/"+c+"-std-view";t({element:n,action:o.VIEW,handlerReference:l}),e([l],(function(e){var n=e.defineViewDialog();(0,r.when)(n.loaded).thenDo(i)}))}(t,n.registerIntentHandler,a);break;case o.DELETE:!function(n,t,i){var a=n.getComponentName(),c=n.getElementName(),l=a+"/"+c+"/"+c+"-std-delete";t({element:n,action:o.DELETE,handlerReference:l}),e([l],(function(e){var n=e.defineDeleteDialog();(0,r.when)(n.loaded).thenDo(i)}))}(t,n.registerIntentHandler,a);break;default:n.registerIntentHandler({element:t,action:i,handlerReference:"no handler"})}},this.registerIntentHandler=function(e){var t=e.element.getQualifiedName();(0,i.isNotDefined)(n.config[t])&&(n.config[t]={}),n.config[t][e.action]=e.handlerReference},this.startListening=function(){(0,r.defineEventListener)({key:"all"}).subscribeOnMessage(n.handleIntent)},this.printConfig=function(){console.log(n.config)}},l=/^\w+\.\w+\.intent\.\w+$/;var d=new c;n.getIntentHandlerLoader=function(){return d}}));