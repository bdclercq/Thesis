define(["require","exports","nsx/util/text-utils"],(function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.clear=n.getQueryValue=n.getLabel=n.createOption=n.setSelectOptions=n.setAutocompleteOptions=n.MORE_VALUE=void 0;var o=(0,t.translate)("ns.dropdown.more"),r=(0,t.translate)("ns.dropdown.none");function a(e,n,t){var o=i(e,t),r=document.createElement("option");return r.label=o,r.value=n,r.setAttribute("name",o),r}function d(e){var t=document.createElement("option");return t.classList.add("dropdown-more"),t.label=e,t.value=n.MORE_VALUE,t}function i(e,n){if(0===e.id)return"";if(n.dropdown.displayFunction)return n.dropdown.displayFunction(e);var t=e[n.dropdown.displayField],o=t.name?t.name:""+t;if(!o)throw"DisplayField '"+n.dropdown.displayField+"' does not exist on "+n.dataElement.getQualifiedName();return n.dropdown.prependId&&(o=e.id+": "+o),o}function l(e){for(;e.firstChild;)e.removeChild(e.firstChild)}n.MORE_VALUE="more",n.setAutocompleteOptions=function(e){var n=e.container,t=e.list,o=e.totalNbItems,r=e.searchString,u=e.params;if(l(n),t.forEach((function(e){var t=a(e,i(e,u),u);n.append(t)})),u.dropdown.includeMore&&o>t.length){var c=d("".concat(r,"... (").concat(o-u.dropdown.maxSize,")"));n.append(c)}},n.setSelectOptions=function(e){var n=e.container,t=e.list,i=e.totalNbItems,u=e.valueFunction,c=e.params;l(n);var p=function(e,n){var t=document.createElement("option");t.label=r(),t.value=e,n.dropdown.required&&(t.disabled=!0);return t}(u({id:0,name:""}),c);if(n.add(p),t.forEach((function(e){var t=a(e,u(e),c);n.add(t)})),c.dropdown.includeMore&&i>t.length){var s=d(o()+"... (".concat(i-c.dropdown.maxSize,")"));n.add(s)}},n.createOption=a,n.getLabel=i,n.getQueryValue=function(e,n){var t=e[n.dropdown.displayField];return t.name?t.name:""+t},n.clear=l}));